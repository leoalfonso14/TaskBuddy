<!DOCTYPE html>
<html lang="en">
  <head>

     <!-- Google tag (gtag.js) -->
     <script async src="https://www.googletagmanager.com/gtag/js?id=G-0KCSZMXRL0"></script>
     <script>
     window.dataLayer = window.dataLayer || [];
       function gtag(){dataLayer.push(arguments);}
       gtag('js', new Date());
 
       gtag('config', 'G-0KCSZMXRL0');
     </script>
     
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap@4.3.1/dist/css/bootstrap.min.css"
      integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T"
      crossorigin="anonymous"
    />
    <link
      href="https://fonts.googleapis.com/css2?family=Poppins:ital,wght@0,600;0,700;0,800;1,400&display=swap"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css"
    />
    <link
      rel="stylesheet"
      href="path/to/font-awesome/css/font-awesome.min.css"
    />
    <link rel="stylesheet" href="calendar.css" />
    <link
      rel="icon"
      type="image/png"
      sizes="32x32"
      href="favicon.io/favicon-16x16.png"
    />

    <link
      href="https://fonts.googleapis.com/css?family=Nunito:400,700"
      rel="stylesheet"
    />

    <title>Calendar</title>
  </head>

  <body>
    <!-- Body of the internal page -->
    <div class="sidenav">
      <div id="topNav">
        <p class="title2" href="internalPage.html">TaskBuddy</p>
        <a href="internalPage.html"
          ><i class="fa fa-home" aria-hidden="true"></i> Dashboard
        </a>
        <a href="ToDoList.html"
          ><i class="fa fa-pencil-square" aria-hidden="true"></i> ToDoList
        </a>
        <a href="calendar.html"
          ><i class="fa fa-calendar-check-o" aria-hidden="true"></i> Calendar
        </a>
        <a href="VirtualPetPage.html"
          ><i class="fa fa-paw" aria-hidden="true"></i> VirtualPet
        </a>
        <a href="Account.html"
          ><i class="fa fa-user" aria-hidden="true"></i> Account
        </a>
      </div>
      <div id="botNav">
        <a href="" class="logout"
          ><i class="fa fa-sign-out" aria-hidden="true"></i> Logout
        </a>
      </div>
    </div>

    <div class="CalendarPage">
      <div class="calendar" id="calendar-app">
        <div class="calendar--day-view" id="day-view">
          <span class="day-view-exit" id="day-view-exit">&times;</span>
          <span class="day-view-date" id="day-view-date">MAY 29 2016</span>
          <div class="day-view-content">
            <div class="day-highlight">
              You
              <span class="day-events" id="day-events"
                >had no events for today</span
              >. &nbsp;
              <span
                tabindex="0"
                onkeyup="if(event.keyCode != 13) return; this.click();"
                class="day-events-link"
                id="add-event"
                data-date
                >Add a new event?</span
              >
            </div>
            <div
              class="day-add-event"
              id="add-day-event-box"
              data-active="false"
            >
              <div class="row">
                <div class="half">
                  <label class="add-event-label">
                    Name of event
                    <input
                      type="text"
                      class="add-event-edit add-event-edit--long"
                      placeholder="New event"
                      id="input-add-event-name"
                    />
                  </label>
                </div>
                <div class="qtr">
                  <label class="add-event-label">
                    Start Time
                    <input
                      type="text"
                      class="add-event-edit"
                      placeholder="8:15"
                      id="input-add-event-start-time"
                      data-options="1,2,3,4,5,6,7,8,9,10,11,12"
                      data-format="datetime"
                    />
                    <input
                      type="text"
                      class="add-event-edit"
                      placeholder="am"
                      id="input-add-event-start-ampm"
                      data-options="a,p,am,pm"
                    />
                  </label>
                </div>
                <div class="qtr">
                  <label class="add-event-label">
                    End Time
                    <input
                      type="text"
                      class="add-event-edit"
                      placeholder="9"
                      id="input-add-event-end-time"
                      data-options="1,2,3,4,5,6,7,8,9,10,11,12"
                      data-format="datetime"
                    />
                    <input
                      type="text"
                      class="add-event-edit"
                      placeholder="am"
                      id="input-add-event-end-ampm"
                      data-options="a,p,am,pm"
                    />
                  </label>
                </div>
                <div class="half">
                  <a
                    onkeyup="if(event.keyCode != 13) return; this.click();"
                    tabindex="0"
                    id="add-event-save"
                    class="event-btn--save event-btn"
                    >save</a
                  >
                  <a
                    tabindex="0"
                    id="add-event-cancel"
                    class="event-btn--cancel event-btn"
                    >cancel</a
                  >
                </div>
              </div>
            </div>
            <div id="day-events-list" class="day-events-list"></div>
            <div onload="listUpcomingEvents()" class="day-inspiration-quote">
              <span id="content"></span>
            </div>
          </div>
        </div>
        <div class="calendar--view" id="calendar-view">
          <div class="cview__month">
            <span class="cview__month-last" id="calendar-month-last">Apr</span>
            <span class="cview__month-current" id="calendar-month">May</span>
            <span class="cview__month-next" id="calendar-month-next">Jun</span>
          </div>
          <div class="cview__header">Sun</div>
          <div class="cview__header">Mon</div>
          <div class="cview__header">Tue</div>
          <div class="cview__header">Wed</div>
          <div class="cview__header">Thu</div>
          <div class="cview__header">Fri</div>
          <div class="cview__header">Sat</div>
          <div class="calendar--view" id="dates"></div>
        </div>
        <div class="footer">
          <span
            ><span id="footer-date" class="footer__link"
              >Today is May 30</span
            ></span
          >
        </div>
      </div>
    </div>
  </body>

  <!--Scripts for firebase connections-->
  <script src="https://www.gstatic.com/firebasejs/8.6.8/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.6.8/firebase-auth.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.6.8/firebase-firestore.js"></script>

  <script
    src="https://code.jquery.com/jquery-3.3.1.slim.min.js"
    integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo"
    crossorigin="anonymous"
  ></script>
  <script
    src="https://cdn.jsdelivr.net/npm/popper.js@1.14.7/dist/umd/popper.min.js"
    integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1"
    crossorigin="anonymous"
  ></script>
  <script
    src="https://cdn.jsdelivr.net/npm/bootstrap@4.3.1/dist/js/bootstrap.min.js"
    integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM"
    crossorigin="anonymous"
  ></script>
  <script src="calendar.js"></script>


    <div class="googleCalendar">
      <p>Google Calendar Login</p>

      <!--Add buttons to initiate auth sequence and sign out-->
      <button id="authorize_button" onclick="handleAuthClick()">Authorize</button>
      <button id="signout_button" onclick="handleSignoutClick()">Sign Out</button>

      <pre id="content" style="white-space: pre-wrap;"></pre>

      <script type="text/javascript">
        /* exported gapiLoaded */
        /* exported gisLoaded */
        /* exported handleAuthClick */
        /* exported handleSignoutClick */

        // TODO(developer): Set to client ID and API key from the Developer Console
        const CLIENT_ID = '708512383332-dcv138klbh391jkmpihrgikq1dqg5d7k.apps.googleusercontent.com';
        const API_KEY = 'AIzaSyCQvAEXJTf7oXADvFlf9PDrNTgbLHFE-Z4';

        // Discovery doc URL for APIs used by the quickstart
        const DISCOVERY_DOC = 'https://www.googleapis.com/discovery/v1/apis/calendar/v3/rest';

        // Authorization scopes required by the API; multiple scopes can be
        // included, separated by spaces.
        const SCOPES = 'https://www.googleapis.com/auth/calendar.readonly';

        let tokenClient;
        let gapiInited = false;
        let gisInited = false;

        document.getElementById('authorize_button').style.visibility = 'hidden';
        document.getElementById('signout_button').style.visibility = 'hidden';

        /**
         * Callback after api.js is loaded.
         */
        function gapiLoaded() {
          gapi.load('client', initializeGapiClient);
        }

        /**
         * Callback after the API client is loaded. Loads the
         * discovery doc to initialize the API.
         */
        async function initializeGapiClient() {
          await gapi.client.init({
            apiKey: API_KEY,
            discoveryDocs: [DISCOVERY_DOC],
          });
          gapiInited = true;
          maybeEnableButtons();
        }

        /**
         * Callback after Google Identity Services are loaded.
         */
        function gisLoaded() {
          tokenClient = google.accounts.oauth2.initTokenClient({
            client_id: CLIENT_ID,
            scope: SCOPES,
            callback: '', // defined later
          });
          gisInited = true;
          maybeEnableButtons();
        }

        /**
         * Enables user interaction after all libraries are loaded.
         */
        function maybeEnableButtons() {
          if (gapiInited && gisInited) {
            document.getElementById('authorize_button').style.visibility = 'visible';
          }
        }

        /**
         *  Sign in the user upon button click.
         */
        function handleAuthClick() {
          tokenClient.callback = async (resp) => {
            if (resp.error !== undefined) {
              throw (resp);
            }
            document.getElementById('signout_button').style.visibility = 'visible';
            document.getElementById('authorize_button').innerText = 'Refresh';
            await listUpcomingEvents();
          };

          if (gapi.client.getToken() === null) {
            // Prompt the user to select a Google Account and ask for consent to share their data
            // when establishing a new session.
            tokenClient.requestAccessToken({prompt: 'consent'});
          } else {
            // Skip display of account chooser and consent dialog for an existing session.
            tokenClient.requestAccessToken({prompt: ''});
          }
        }

        /**
         *  Sign out the user upon button click.
         */
        function handleSignoutClick() {
          const token = gapi.client.getToken();
          if (token !== null) {
            google.accounts.oauth2.revoke(token.access_token);
            gapi.client.setToken('');
            document.getElementById('content').innerText = '';
            document.getElementById('authorize_button').innerText = 'Authorize';
            document.getElementById('signout_button').style.visibility = 'hidden';
          }
        }

        /**
         * Print the summary and start datetime/date of the next ten events in
         * the authorized user's calendar. If no events are found an
         * appropriate message is printed.
         */
        async function listUpcomingEvents() {
          let response;
          try {
            const request = {
              'calendarId': 'primary',
              'timeMin': (new Date()).toISOString(),
              'showDeleted': false,
              'singleEvents': true,
              'maxResults': 10,
              'orderBy': 'startTime',
            };
            response = await gapi.client.calendar.events.list(request);
          } catch (err) {
            document.getElementById('content').innerText = err.message;
            return;
          }

          const events = response.result.items;
          if (!events || events.length == 0) {
            document.getElementById('content').innerText = 'No events found.';
            return;
          }
          // Flatten to string to display
          const output = events.reduce(
              (str, event) => `${str}${event.summary} (${event.start.dateTime || event.start.date})\n`,
              '\n');
          document.getElementById('content').innerText = output;
        }
      </script>
      <script async defer src="https://apis.google.com/js/api.js" onload="gapiLoaded()"></script>
      <script async defer src="https://accounts.google.com/gsi/client" onload="gisLoaded()"></script>
    </div>
  </body>

</html>



